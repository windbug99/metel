# Stage 6 E2E Test Sheet

목적:
- Staging에서 V2 전환 전/중에 Telegram 실사용 문장을 검증하고 결과를 기록한다.

실행 조건(현재 운영 기준):
- `SKILL_ROUTER_V2_ENABLED=true`
- `SKILL_RUNNER_V2_ENABLED=true`
- `SKILL_ROUTER_V2_LLM_ENABLED=true`
- `SKILL_V2_SHADOW_MODE=false`
- `SKILL_V2_TRAFFIC_PERCENT=100`

기록 방법:
- 아래 표의 `실제 결과`, `판정`, `비고`를 채운다.
- 실패 건은 동일 문장 1회 재시도 후에도 실패면 `FAIL` 처리한다.

## 1) LLM_ONLY 기본

| ID | 입력 문장 | 기대 결과 | 실제 결과 | 판정(PASS/FAIL) | 비고 |
|---|---|---|---|---|---|
| L1 | 한국의 수도는? | 일반 지식 답변 |  |  |  |
| L2 | 지금 할 수 있는 기능 알려줘 | 기능 안내 답변 |  |  |  |

## 2) SKILL_THEN_LLM (Read)

| ID | 입력 문장 | 기대 결과 | 실제 결과 | 판정(PASS/FAIL) | 비고 |
|---|---|---|---|---|---|
| R1 | linear 최근 이슈 3개 검색해줘 | 이슈 3건 목록 + 링크 |  |  |  |
| R2 | linear의 OPT-43 이슈 설명을 해결 방법으로 정리해줘 | 이슈 조회 후 해결방안 요약 |  |  |  |
| R3 | notion 최근 페이지 3개 검색해줘 | 페이지 목록 + 링크 |  |  |  |

## 3) LLM_THEN_SKILL (Write)

| ID | 입력 문장 | 기대 결과 | 실제 결과 | 판정(PASS/FAIL) | 비고 |
|---|---|---|---|---|---|
| W1 | linear 이슈 생성 팀: operate 제목: 비밀번호 찾기 오류 | 이슈 생성 성공 + 링크 |  |  |  |
| W2 | linear opt-46 이슈 제목을 add openweather로 수정하세요 | 제목 수정 성공 + 링크 |  |  |  |
| W3 | linear opt-46 이슈 설명 업데이트: 패시브 서비스 추가 | 설명 수정 성공 + 링크 |  |  |  |
| W4 | linear opt-45 이슈를 삭제하세요 | 정책 차단 응답(`delete_disabled`) |  |  |  |
| W5 | 노션에서 "스프린트 보고서" 페이지 제목을 "스프린트 프리뷰"로 업데이트해줘 | 제목 변경 성공 + 링크 |  |  |  |
| W6 | 노션에서 "스프린트 보고서" 페이지 본문 업데이트: 내가 돌아왔다 | 본문 추가 성공 + 링크 |  |  |  |
| W7 | 노션에서 "스프린트 프리뷰" 페이지 삭제해줘 | 정책 차단 응답(`delete_disabled`) |  |  |  |

## 4) needs_input 재개

| ID | 입력 문장 | 후속 입력 | 기대 결과 | 실제 결과 | 판정(PASS/FAIL) | 비고 |
|---|---|---|---|---|---|---|
| N1 | linear에 이슈 생성 | operate | 팀 슬롯 반영 후 다음 입력 유도 또는 생성 진행 |  |  |  |
| N2 | (N1 이후) 제목: 테스트 이슈 | - | 이슈 생성 성공 + 링크 |  |  |  |
| N3 | 노션에서 "스프린트 회고" 페이지 업데이트해줘 | 제목을 "스프린트 보고서"로 변경해줘 | 제목 변경 성공 |  |  |  |

## 5) 금지/오류 케이스

| ID | 입력 문장 | 기대 결과 | 실제 결과 | 판정(PASS/FAIL) | 비고 |
|---|---|---|---|---|---|
| E1 | linear 이슈 업데이트 | patch 필요 안내(needs_input) |  |  |  |
| E2 | notion 페이지 업데이트 | patch 필요 안내(needs_input) |  |  |  |
| E3 | 연결 안 된 서비스 조작 문장 | 즉시 실패 또는 연결 안내 |  |  |  |

## 6) 종합 판정

- PASS 기준:
  - 치명 오류 없음 (`unsupported_service`, `unsupported_skill` 반복 없음)
  - needs_input -> 후속 입력 재개 정상
  - CRUD 시나리오(Linear/Notion) 최소 1회 이상 성공

- 결과 요약:
  - 총 PASS: 
  - 총 FAIL: 
  - 주요 실패 패턴:
  - 재현 가능한 실패 문장:

## 7) Skill+LLM Transform (신규)

사전 조건:
- `SKILL_LLM_TRANSFORM_PIPELINE_ENABLED=true`

| ID | 입력 문장 | 기대 결과 | 실제 결과 | 판정(PASS/FAIL) | 비고 |
|---|---|---|---|---|---|
| T1 | 구글캘린더에서 오늘 일정 중 회의일정만 조회해서 노션에 상세한 회의록 서식으로 생성하세요 | 회의 이벤트만 필터되어 Notion N페이지 생성(비회의 제외) |  |  |  |
| T2 | 구글캘린더에서 오늘 일정 중 회의일정만 조회해서 노션에 상세한 회의록 서식으로 생성하세요 (회의 0건) | 실패가 아닌 성공형 응답(조건 일치 일정 없음) |  |  |  |
| T3 | (동일 요청 재실행) | 중복 생성 정책(idempotency) 위반 없음 |  |  |  |
| T4 | 구글캘린더에서 오늘 일정 중 회의일정만 조회해서 리니어에 회의록 서식 이슈 생성 | 회의 이벤트만 필터되어 Linear N이슈 생성(비회의 제외) |  |  |  |
