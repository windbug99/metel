SUPABASE_URL=
SUPABASE_SERVICE_ROLE_KEY=

NOTION_CLIENT_ID=
NOTION_CLIENT_SECRET=
NOTION_REDIRECT_URI=
NOTION_STATE_SECRET=
NOTION_TOKEN_ENCRYPTION_KEY=
NOTION_API_VERSION=2025-09-03
NOTION_DEFAULT_PARENT_PAGE_ID=

LINEAR_CLIENT_ID=
LINEAR_CLIENT_SECRET=
LINEAR_REDIRECT_URI=
LINEAR_STATE_SECRET=
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=
GOOGLE_REDIRECT_URI=
GOOGLE_STATE_SECRET=

SPOTIFY_CLIENT_ID=
SPOTIFY_CLIENT_SECRET=
SPOTIFY_REDIRECT_URI=
SPOTIFY_STATE_SECRET=

GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=
GOOGLE_REDIRECT_URI=
GOOGLE_STATE_SECRET=

TELEGRAM_BOT_TOKEN=
TELEGRAM_LINK_SECRET=
TELEGRAM_WEBHOOK_SECRET=
TELEGRAM_BOT_USERNAME=

CONVERSATION_MODE_ENABLED=true
TELEGRAM_USER_PREFACE_ENABLED=true
TELEGRAM_USER_PREFACE_LLM_ENABLED=true
TELEGRAM_USER_PREFACE_MAX_CHARS=240
TELEGRAM_DEBUG_REPORT_ENABLED=false
TELEGRAM_MESSAGE_MAX_CHARS=3500
RULE_REPARSE_FOR_LLM_PLAN_ENABLED=false
PENDING_ACTION_STORAGE=db
PENDING_ACTION_TTL_SECONDS=900
PENDING_ACTION_TABLE=pending_actions
# Optional: external slot schema override file path (JSON)
SLOT_SCHEMA_PATH=
SLOT_LOOP_ENABLED=true
SLOT_LOOP_ROLLOUT_PERCENT=100
SLOT_LOOP_METRICS_ENABLED=true

FRONTEND_URL=http://localhost:3000
ALLOWED_ORIGINS=http://localhost:3000,https://metel.vercel.app

# LLM planner preference (target configuration)
LLM_PLANNER_ENABLED=true
LLM_PLANNER_RULE_FALLBACK_ENABLED=true
LLM_PLANNER_PROVIDER=openai
LLM_PLANNER_MODEL=gpt-4o-mini
LLM_PLANNER_FALLBACK_PROVIDER=google
LLM_PLANNER_FALLBACK_MODEL=gemini-2.5-flash-lite
LLM_REQUEST_TIMEOUT_SEC=20
LLM_REQUEST_MAX_RETRIES=1

LLM_AUTONOMOUS_ENABLED=false
LLM_AUTONOMOUS_MAX_TURNS=6
LLM_AUTONOMOUS_MAX_TOOL_CALLS=8
LLM_AUTONOMOUS_TIMEOUT_SEC=45
LLM_AUTONOMOUS_REPLAN_LIMIT=1
LLM_AUTONOMOUS_STRICT=false
LLM_AUTONOMOUS_STRICT_TOOL_SCOPE=true
LLM_AUTONOMOUS_LIMIT_RETRY_ONCE=true
LLM_AUTONOMOUS_RULE_FALLBACK_ENABLED=true
LLM_AUTONOMOUS_RULE_FALLBACK_MUTATION_ENABLED=false
LLM_AUTONOMOUS_PROGRESSIVE_NO_FALLBACK_ENABLED=true
LLM_AUTONOMOUS_VERIFIER_ENABLED=false
LLM_AUTONOMOUS_VERIFIER_FAIL_CLOSED=false
LLM_AUTONOMOUS_VERIFIER_MAX_HISTORY=8
LLM_AUTONOMOUS_VERIFIER_REQUIRE_TOOL_EVIDENCE=true
LLM_AUTONOMOUS_GUARDRAIL_ENABLED=true
LLM_AUTONOMOUS_GUARDRAIL_TOOL_ERROR_RATE_THRESHOLD=0.6
LLM_AUTONOMOUS_GUARDRAIL_REPLAN_RATIO_THRESHOLD=0.5
LLM_AUTONOMOUS_GUARDRAIL_CROSS_SERVICE_BLOCK_THRESHOLD=1
LLM_HYBRID_EXECUTOR_FIRST=false
LLM_RESPONSE_FINALIZER_ENABLED=false
TOOL_SPECS_VALIDATE_ON_STARTUP=true
OPENAI_API_KEY=...
GOOGLE_API_KEY=...

# Skill V2 migration / rollout
# Enable both flags to activate V2 orchestration path.
SKILL_ROUTER_V2_ENABLED=false
SKILL_RUNNER_V2_ENABLED=false
# Optional: LLM-based router decision before rule fallback.
SKILL_ROUTER_V2_LLM_ENABLED=false
# Shadow mode: execute V2 but keep legacy response.
SKILL_V2_SHADOW_MODE=false
# Percent of traffic served by V2 (0~100).
SKILL_V2_TRAFFIC_PERCENT=100
# Optional comma-separated user_id allowlist for forced V2.
SKILL_V2_ALLOWLIST=
